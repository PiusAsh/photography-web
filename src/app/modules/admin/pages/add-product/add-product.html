<div class="add-product-container">
  <div class="page-header border-bottom">
    <div class="header-content">
      <h1 class="page-title">
        Create New Product
      </h1>
      <p class="page-subtitle">Add a new photography product to your store</p>
    </div>
  </div>

  <div class="form-container">
    <form [formGroup]="productForm" (ngSubmit)="onSubmit()">
      
      <!-- Basic Information Card -->
      <div class="form-card">
        <div class="card-header">
          <i class="bi bi-info-circle"></i>
          <h3>Basic Information</h3>
        </div>
        <div class="card-content">
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">
                <i class="bi bi-tag"></i>
                Product Name <span class="required">*</span>
              </label>
              <input class="form-input" formControlName="name" placeholder="Enter product name">
              <div *ngIf="productForm.get('name')?.invalid && productForm.get('name')?.touched" class="error-message">
                <i class="bi bi-exclamation-circle"></i>
                Product name is required.
              </div>
            </div>
            
          </div>
          
          <div class="form-group">
            <label class="form-label">
              <i class="bi bi-file-text"></i>
              Description <span class="required">*</span>
            </label>
            <textarea class="form-input" formControlName="description" placeholder="Enter product description"></textarea>
            <div *ngIf="productForm.get('description')?.invalid && productForm.get('description')?.touched" class="error-message">
              <i class="bi bi-exclamation-circle"></i>
              Description is required.
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">
              <i class="bi bi-calendar"></i>
              Year <span class="required">*</span>
            </label>
            <input type="number" class="form-input" formControlName="year" placeholder="Enter year">
            <div *ngIf="productForm.get('year')?.invalid && productForm.get('year')?.touched" class="error-message">
              <i class="bi bi-exclamation-circle"></i>
              Year is required.
            </div>
          </div>
        </div>
      </div>

      

      <!-- Variants Card -->
      <div class="form-card mt-2 mb-2">
        <div class="card-header">
          <i class="bi bi-box"></i>
          <h3>Product Variants</h3>
        </div>
        <div class="card-content">
          <div formArrayName="variants">
            <div *ngFor="let variantControl of variants.controls; let i=index" [formGroupName]="i" class="dynamic-item">
              <div class="item-inputs">
                <div class="form-group">
                  <label class="form-label">Price <span class="required">*</span></label>
                  <input type="number" class="form-input" formControlName="price" placeholder="Price">
                  <div *ngIf="variantControl.get('price')?.invalid && variantControl.get('price')?.touched" class="error-message">
                    <i class="bi bi-exclamation-circle"></i>
                    Price is required.
                  </div>
                </div>
                <div class="form-group">
                  <label class="form-label">Type <span class="required">*</span></label>
                  <input class="form-input" formControlName="type" placeholder="Type (e.g., Canvas, Print)">
                  <div *ngIf="variantControl.get('type')?.invalid && variantControl.get('type')?.touched" class="error-message">
                    <i class="bi bi-exclamation-circle"></i>
                    Type is required.
                  </div>
                </div>
                <div class="form-group">
                  <label class="form-label">Size <span class="required">*</span></label>
                  <input class="form-input" formControlName="size" placeholder="Size (e.g., 20x20, A4)">
                  <div *ngIf="variantControl.get('size')?.invalid && variantControl.get('size')?.touched" class="error-message">
                    <i class="bi bi-exclamation-circle"></i>
                    Size is required.
                  </div>
                </div>
              </div>
              <button type="button" class="btn-remove" (click)="removeVariant(i)">
                <i class="bi bi-trash"></i>
              </button>
            </div>
            <button type="button" class="btn-add" (click)="addVariant()">
              <i class="bi bi-plus"></i>
              Add Variant
            </button>
          </div>
        </div>
      </div>

      <!-- Images Card -->
      <div class="form-card">
        <div class="card-header">
          <i class="bi bi-images"></i>
          <h3>Product Images</h3>
        </div>
        <div class="card-content">
          
          <!-- Main Image -->
          <div class="form-group">
            <label class="form-label">
              <i class="bi bi-star"></i>
              Main Image
            </label>
            <div class="image-upload-area" 
                 (click)="mainFileInput.click()"
                 (dragover)="onDragOver($event)"
                 (dragleave)="onDragLeave($event)"
                 (drop)="onDrop($event, 'main')"
                 [class.drag-over]="isDragOver">
              <ng-container *ngIf="!mainImagePreviewUrl">
                <div class="upload-placeholder">
                  <i class="bi bi-cloud-upload"></i>
                  <p>Click to upload or drag & drop main image</p>
                  <span>Recommended: 800x600px</span>
                </div>
              </ng-container>
              <ng-container *ngIf="mainImagePreviewUrl">
                <img [src]="mainImagePreviewUrl" alt="Main Image Preview" class="image-preview">
                <button type="button" class="btn-remove-image" (click)="removeMainImage($event)">
                  <i class="bi bi-x"></i>
                </button>
              </ng-container>
            </div>
            <input type="file" #mainFileInput style="display: none;" (change)="onFileSelected($event)">
          </div>

          <!-- Additional Images -->
          <div class="form-group">
            <label class="form-label">
              <i class="bi bi-collection"></i>
              Additional Images
            </label>
            <div class="image-upload-area" 
                 (click)="multipleFileInput.click()"
                 (dragover)="onDragOver($event)"
                 (dragleave)="onDragLeave($event)"
                 (drop)="onDrop($event, 'additional')"
                 [class.drag-over]="isDragOver">
              <div class="upload-placeholder">
                <i class="bi bi-cloud-upload"></i>
                <p>Click to upload or drag & drop additional images</p>
                <span>You can select multiple files</span>
              </div>
            </div>
            <input type="file" #multipleFileInput style="display: none;" (change)="onMultipleFilesSelected($event)" multiple>
            
            <div class="additional-images-preview">
              <div *ngFor="let imageUrl of additionalImagePreviewUrls; let i = index" class="image-preview-item">
                <img [src]="imageUrl" alt="Additional Image Preview" class="image-preview">
                <button type="button" class="btn-remove-image" (click)="removeAdditionalImage(i)">
                  <i class="bi bi-x"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Submit Button -->
      <div class="submit-section">
        <button type="submit" class="btn-submit" [disabled]="productForm.invalid">
          <i class="bi bi-check-circle"></i>
          Create Product
        </button>
      </div>
    </form>
  </div>
</div>