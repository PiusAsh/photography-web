<app-navbar class="mb-3"></app-navbar>

<div class="checkout-container mt-5">
  <!-- Header Section -->
  <!-- <div class="checkout-header">
    <div class="container">
      <div class="header-content">
        <div class="header-left">
          <h1 class="checkout-title">
            <i class="bi bi-credit-card"></i>
            Checkout
          </h1>
          <p class="checkout-subtitle">Complete your order securely</p>
        </div>
        <div class="header-right">
          <button class="btn-back-to-cart" (click)="goBackToCart()">
            <i class="bi bi-arrow-left"></i>
            Back to Cart
          </button>
        </div>
      </div>
    </div>
  </div> -->

   <div class="cart-header mt-5">
    <div class="container">
      <div class="header-content">
        <div class="header-left mt-5">
          <h1 class="cart-title">
            <i class="bi bi-cart3"></i>
Checkout
          </h1>
          <p class="cart-subtitle">Complete your order securely</p>
        </div>
        <!-- <div class="header-right">
          <button class="btn-continue-shopping" (click)="goBackToCart()">
                       <i class="bi bi-credit-card"></i>
                        Back to Cart
          </button>
        </div> -->
      </div>
    </div>
  </div>
  <!-- Main Content -->
  <div class="checkout-main">
    <div class="container">
      <div class="checkout-content">
        <div class="checkout-layout">
          <!-- Billing Form -->
          <div class="billing-section">
            <div class="section-card">
              <div class="section-header">
                <h3>
                  <i class="bi bi-person-circle"></i>
                  Billing Details
                </h3>
                <p class="section-subtitle">Please provide your information to complete the order</p>
              </div>

              <form [formGroup]="checkoutForm" (ngSubmit)="submitOrder()" class="billing-form">
                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label">
                      <!-- <i class="bi bi-person"></i> -->
                      Full Name
                    </label>
                    <input 
                      type="text" 
                      class="form-control auth-input" 
                      formControlName="name"
                      placeholder="Enter your full name"
                    />
                    <div class="error-message" *ngIf="f['name'].touched && f['name'].invalid">
                      <i class="bi bi-exclamation-circle"></i>
                      Name is required
                    </div>
                  </div>

                  <div class="form-group">
                    <label class="form-label">
                      <!-- <i class="bi bi-envelope"></i> -->
                      Email Address
                    </label>
                    <input 
                      type="email" 
                      class="form-control auth-input" 
                      formControlName="email"
                      placeholder="Enter your email address"
                    />
                    <div class="error-message" *ngIf="f['email'].touched && f['email'].invalid">
                      <i class="bi bi-exclamation-circle"></i>
                      Valid email is required
                    </div>
                  </div>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label">
                      <!-- <i class="bi bi-telephone"></i> -->
                      Phone Number
                    </label>
                    <input 
                      type="tel" 
                      class="form-control auth-input" 
                      formControlName="phone"
                      placeholder="Enter your phone number"
                    />
                    <div class="error-message" *ngIf="f['phone'].touched && f['phone'].invalid">
                      <i class="bi bi-exclamation-circle"></i>
                      Valid phone number is required
                    </div>
                  </div>

                  <div class="form-group">
                    <label class="form-label">
                      <!-- <i class="bi bi-geo-alt"></i> -->
                      Delivery Address
                    </label>
                    <input 
                      #addressText 
                      type="text" 
                      class="form-control auth-input" 
                      formControlName="address"
                      GoogleMap 
                      (addressChange)="onAddressChange($event)"
                      placeholder="Enter your delivery address"
                    />
                    <div class="error-message" *ngIf="f['address'].touched && f['address'].invalid">
                      <i class="bi bi-exclamation-circle"></i>
                      Address is required
                    </div>
                  </div>
                </div>

              </form>
            </div>
          </div>

          <!-- Order Summary -->
          <div class="order-summary-section">
            <div class="summary-card">
              <div class="summary-header">
                <h3>
                  <i class="bi bi-cart-check"></i>
                  Order Summary
                </h3>
                <span class="item-count">{{ cartItems.length }} items</span>
              </div>

              <div class="order-items">
                <div class="order-item" *ngFor="let item of cartItems">
                  <div class="item-image">
                    <img [src]="item.product.mainImage" [alt]="item.product.name" />
                  </div>
                  
                  <div class="item-details">
                    <h4 class="item-name">{{ item.product.name }}</h4>
                    <!-- <p class="item-description">{{ item.product.description }}</p> -->
                    <div class="item-meta">
                      <span class="item-year" style="width: max-content;">{{ item.product.year }}</span>
                      <span class="item-quantity" style="width: max-content;">Qty: {{ item.quantity }}</span>
                    </div>
                  </div>
                  
                  <div class="item-price ">
                    <span class="unit-price">{{ item.product.price | currencyFormat }}</span>
                    <span class="total-price">{{ (item.product.price * item.quantity) | currencyFormat}}</span>
                  </div>
                </div>
              </div>

                             <div class="summary-breakdown">
                 <div class="breakdown-row">
                   <span>Subtotal</span>
                   <span>{{ getTotal() | currencyFormat }}</span>
                 </div>
                 
                 <div class="breakdown-row">
                   <span>Shipping</span>
                   <span class="text-success">Free Within Nigeria</span>
                 </div>
                 
                 <div class="breakdown-divider"></div>
                 
                 <div class="breakdown-row total-row">
                   <span>Total</span>
                   <span class="total-amount">{{ getTotal() | currencyFormat }}</span>
                 </div>
               </div>

               <div class="payment-actions">
                 <button 
                   class="btn btn-primary w-100" 
                   type="submit" 
                   [disabled]="checkoutForm.invalid || isProcessing"
                   (click)="submitOrder()"
                 >
                   <!-- <i class="bi bi-credit-card"></i> -->
                   <span *ngIf="!isProcessing">{{'Pay Now' }}</span>
                   <!-- <span *ngIf="!isProcessing">Pay â‚¦{{ getTotal().toLocaleString() }}</span> -->
                   <span *ngIf="isProcessing">Processing...</span>
                 </button>
               </div>

               <div class="secure-payment">
                 <div class="security-badge">
                   <i class="bi bi-shield-check"></i>
                   <span>Secure Payment</span>
                 </div>
                 <p class="security-text">Your payment information is encrypted and secure</p>
               </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<app-footer></app-footer>
